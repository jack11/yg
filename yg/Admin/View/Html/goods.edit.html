<include file="Common/header"/>

<div class="page">
	<div class="fixed-bar">
		<div class="item-title">
			<h3>商品发布</h3>
			<ul class="tab-base">
		        <li><a href="_ADMIN_URL_/goods/index" ><span>所有商品</span></a></li>
		        <li><a href="JavaScript:void(0);" class="current"><span>增加</span></a></li>
		        <li><a href="_ADMIN_URL_/goods/setting"><span>商品设置</span></a></li>
		    </ul>
		</div>
	</div>
	<div class="fixed-empty" ></div>
	<form method="post" enctype="multipart/form-data" name="form1" id="goods_form">
		<input type="hidden" name="form_submit" value="ok">
		<table class="table tb-type2">
			<tbody>
				
				<tr class="noborder" style="background: rgb(255, 255, 255);">
					<td colspan="2" class="required"><label for="goods_name" class="validation">商品名称:</label></td>
				</tr>
				<tr class="noborder" style="background: rgb(255, 255, 255);">
					<td class="vatop rowform">
					<input id="goods_name" name="goods_name" value="{$tmp.goods_name}" class="txt" type="text">
					</td>
					<td class="vatop tips"><span class="vatop rowform">商品名称</span></td>
				</tr>
				
				<tr class="noborder" style="background: rgb(255, 255, 255);">
					<td colspan="2" class="required"><label for="goods_jingle">广告词:</label></td>
				</tr>
				<tr class="noborder" style="background: rgb(255, 255, 255);">
					<td class="vatop rowform">
					<input id="goods_jingle" name="goods_jingle" value="{$tmp.goods_jingle}" class="txt" type="text">
					</td>
					<td class="vatop tips"><span class="vatop rowform">商品广告词</span></td>
				</tr>
				
				<tr class="noborder" style="background: rgb(255, 255, 255);">
					<td colspan="2" class="required"><label for="goods_class" class="validation">商品分类:</label></td>
				</tr>
				<tr class="noborder" style="background: rgb(255, 255, 255);">
					<td class="vatop rowform">
					<select name="goods_class" id="goods_class">
						<option value="">请选择...</option>
						<foreach name="class_list" item="v">
						<option value="{$v.class_id}">{$v.class_name}</option>
						</foreach>
					</select>
					</td>
					<td class="vatop tips"><span class="vatop rowform">商品名称</span></td>
				</tr>
				
				<tr class="noborder" style="background: rgb(255, 255, 255);">
					<td colspan="2" class="required"><label for="brand_id">商品品牌:</label></td>
				</tr>
				<tr class="noborder" style="background: rgb(255, 255, 255);">
					<td class="vatop rowform">
					<select name="brand_id" id="brand_id">
						<option value="">请选择...</option>
					</select>
					</td>
					<td class="vatop tips"><span class="vatop rowform">选择分类后自动获取品牌</span></td>
				</tr>

				
				<tr style="background: rgb(255, 255, 255);">
					<td colspan="2" class="required"><label for="shop_price" class="validation">商品价格:</label></td>
				</tr>
				<tr class="noborder" style="background: rgb(255, 255, 255);">
					<td class="vatop rowform">
					<input id="shop_price" name="shop_price" value="{$tmp.shop_price}" class="txt" type="text">
					</td>
					<td class="vatop tips"><span class="vatop rowform">商品价格</span></td>
				</tr>
				
				<tr style="background: rgb(255, 255, 255);">
					<td colspan="2" class="required"><label for="goods_number" class="validation">共有多少份:</label></td>
				</tr>
				<tr class="noborder" style="background: rgb(255, 255, 255);">
					<td class="vatop rowform">
					<input id="goods_number" name="goods_number" value="" readonly="readonly" class="txt" type="text">
					</td>
					<td class="vatop tips"><span class="vatop rowform">总价格除以每份多少钱得出的结果</span></td>
				</tr>
				
				<tr style="background: rgb(255, 255, 255);">
					<td colspan="2" class="required"><label for="is_new" class="validation">是否是新品:</label></td>
				</tr>
				<tr class="noborder" style="background: rgb(255, 255, 255);">
					<td class="vatop rowform">
					<input id="is_new" name="is_new" value="1" class="" type="radio">是
					<input id="is_new" name="is_new" value="0" class="" type="radio" checked="checked">否
					</td>
					<td class="vatop tips"><span class="vatop rowform">是否是新品</span></td>
				</tr>
				
				<tr style="background: rgb(255, 255, 255);">
					<td colspan="2" class="required"><label for="is_commend" class="validation">是否推荐:</label></td>
				</tr>
				<tr class="noborder" style="background: rgb(255, 255, 255);">
					<td class="vatop rowform">
					<input id="is_commend" name="is_commend" value="1" class="" type="radio">是
					<input id="is_commend" name="is_commend" value="0" class="" type="radio" checked="checked">否
					</td>
					<td class="vatop tips"><span class="vatop rowform">是否推荐</span></td>
				</tr>
				
				<tr style="background: rgb(255, 255, 255);">
					<td colspan="2" class="required"><label for="state_time">商品开始销售时间:</label></td>
				</tr>
				<tr class="noborder" style="background: rgb(255, 255, 255);">
					<td class="vatop rowform">
					<input id="state_time" name="state_time" value=""  class="txt" type="text">
					</td>
					<td class="vatop tips"><span class="vatop rowform">商品开始销售时间,不选则某人商品发布时就开始销售</span></td>
				</tr>
				
				<tr style="background: rgb(255, 255, 255);">
					<td colspan="2" class="required"><label for="end_time">商品结束时间:</label></td>
				</tr>
				<tr class="noborder" style="background: rgb(255, 255, 255);">
					<td class="vatop rowform">
					<input id="end_time" name="end_time" value=""  class="txt" type="text">
					</td>
					<td class="vatop tips"><span class="vatop rowform">商品结束的时候，如果不选则默认7天结束</span></td>
				</tr>
				
				<tr style="background: rgb(255, 255, 255);">
					<td colspan="2" class="required"><label for="goods_images" class="validation">商品主图:</label></td>
				</tr>
				<tr class="noborder" style="background: rgb(255, 255, 255);">
					<td class="vatop rowform"><span class="type-file-show"><img class="show_image" src="_IMG_/preview.png">
						<div class="type-file-preview"><img src="_UPIMG_/{$setting.site_logo}">
						</div> </span><span class="type-file-box">
						<input type="text" name="textfield" id="textfield1" class="type-file-text">
						<input type="button" name="button" id="button1" value="" class="type-file-button">
						<input name="goods_images" type="file" class="type-file-file" id="site_logo" size="30" hidefocus="true" nc_type="change_site_logo">
					</span></td>
					<td class="vatop tips"><span class="vatop rowform">180px * 50px</span></td>
				</tr>
				
				<tr style="background: rgb(255, 255, 255);">
					<td colspan="2" class="required"><label for="" >商品属性:</label></td>
				</tr>
				<tr class="noborder" style="background: rgb(255, 255, 255);">
					<td class="vatop rowform">
					<input id="attribute_name" name="attr[0][name]" value="" class="" type="text">：
					<input id="attribute_value" name="attr[0][value]" value="" class="" type="text">
					</td>
					<td class="vatop tips"><span class="vatop rowform">商品的属性</span></td>
				</tr>
				
				<tr style="background: rgb(255, 255, 255);">
					<td colspan="2" class="required"><label for="view_count">商品浏览次数:</label></td>
				</tr>
				<tr class="noborder" style="background: rgb(255, 255, 255);">
					<td class="vatop rowform">
					<input id="view_count" name="view_count" value="{$tmp.view_count}" class="txt" type="text">
					</td>
					<td class="vatop tips"><span class="vatop rowform">可以设定商品被浏览过多少次</span></td>
				</tr>
				
				<tr style="background: rgb(255, 255, 255);">
					<td colspan="2" class="required"><label for="content">商品详情:</label></td>
				</tr>
				<tr class="noborder" style="background: rgb(255, 255, 255);">
					<td class="vatop rowform" colspan="2">
					<script id="editor" type="text/plain" name="content" style="width:1024px;height:500px;"></script>
					</td>
					
				</tr>
				
				
			</tbody>
			<tfoot id="submit-holder">
				<tr class="tfoot">
					<td colspan="2"><a href="JavaScript:void(0);" class="btn" ><span>提交</span></a></td>
				</tr>
			</tfoot>
		</table>
	</form>
</div>

<script type="text/javascript">
	// 模拟网站LOGO上传input type='file'样式
	$(function() {
		$('.btn').click(function (){
			$('#goods_form').submit();
		})
		
		
		
		$('#goods_form').validate({
			errorPlacement:function(error,element){
        		var td = $(element).parents('tr').prev('tr').find('td');
        		td.append(error);
			},
			
			rules:{
				goods_name:{
					required:true,
					maxlength:20,
				},
				goods_class:{
					required:true,
				},
				shop_price:{
					required:true,
					number:true,
					min:0,
				},
				goods_number:{
					required:true,
				},
				is_new:{
					required:true,
				},
				is_commend:{
					required:true,
				},
				goods_images:{
					required:true,
				},
			},
			messages:{
				goods_name:{
					required:'商品名称不能未空',
					maxlength:'长度不能超过20个字符',
				},
				goods_class:{
					required:'请选择分类',
				},
				shop_price:{
					required:'商品价格不能为空',
					number:'商品价格只能是数字',
					min:'价格不可以低于0',
				},
				goods_number:{
					required:'请填写价格',
				},
				is_new:{
					required:'是否是新品',
				},
				is_commend:{
					required:'是否是推荐',
				},
				goods_images:{
					required:'请选择商品主图',
				},
				
			},
		})
		
		//算有多少份
		var per_price = {$per_price+0};	//每份价格
		$('#shop_price').change(function(){
			var price = parseInt($(this).val());
			if(typeof price != 'undefined' && price>0 && per_price){
				$('#goods_number').val(Math.ceil(price/per_price));
			}
		})
		
		//获取品牌
		$('#goods_class').change(function (){
			var class_id = $(this).val();
			var url = '_ADMIN_URL_/goods/getBrandAjax';
			
			//移除品牌
			$('option[yg_type="brand_item"]').remove();
			if(!class_id){
				return ;
			}
			$.get(url,{'class_id':class_id},function(data){
				if(data.state){
					$(data.data).each(function(id,brand){
						var option = $('<option yg_type="brand_item" value="'+brand.brand_id+'"></option');
						option.html(brand.brand_name);
						$('#brand_id').append(option);
					})
				}else{
					alert('获取品牌失败');
				}
			},'json')
		})
	}); 
</script>


<script type="text/javascript" charset="utf-8" src="__PUBLIC__/ueditor/ueditor.config.js"></script>
<script type="text/javascript" charset="utf-8" src="__PUBLIC__/ueditor/ueditor.all.min.js"> </script>
<!--建议手动加在语言，避免在ie下有时因为加载语言失败导致编辑器加载失败-->
<!--这里加载的语言文件会覆盖你在配置项目里添加的语言类型，比如你在配置项目里配置的是英文，这里加载的中文，那最后就是中文-->
<!-- <script type="text/javascript" charset="utf-8" src="lang/zh-cn/zh-cn.js"></script> -->
<script type="text/javascript">
var ue = UE.getEditor('editor');
</script>
</body></html>




</body>
</html>